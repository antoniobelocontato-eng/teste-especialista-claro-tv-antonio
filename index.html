<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CineClaro - Intelig√™ncia de Vendas</title>
    <style>
        :root { --claro-red: #ee1d23; --deep-black: #0a0a0a; --surface: #1a1a1a; }
        body { background: radial-gradient(circle at top, #3a0000 0%, #0a0a0a 100%) fixed; color: white; font-family: 'Inter', sans-serif; margin: 0; padding: 20px; }
        
        .header-nav { display: flex; flex-wrap: wrap; gap: 15px; margin-bottom: 40px; justify-content: center; align-items: center; }
        
        /* Bot√£o Vem A√≠ */
        .btn-coming-soon { background: #ffd700; color: black !important; padding: 15px 25px; border: none; border-radius: 50px; cursor: pointer; font-weight: bold; transition: 0.3s; }
        .btn-coming-soon:hover { transform: scale(1.1); box-shadow: 0 0 20px rgba(255, 215, 0, 0.4); }

        .dropbtn { background: #222; color: white; padding: 15px 25px; border: 1px solid var(--claro-red); border-radius: 8px; cursor: pointer; font-weight: bold; }
        .dropdown { position: relative; display: inline-block; }
        .dropdown-content { display: none; position: absolute; background: #222; min-width: 220px; z-index: 100; border-radius: 8px; box-shadow: 0 8px 16px rgba(0,0,0,0.5); }
        .dropdown-content a { color: white; padding: 15px; text-decoration: none; display: block; border-bottom: 1px solid #333; cursor: pointer; }
        .dropdown:hover .dropdown-content { display: block; }

        .btn-filter-logo { background: #000; border: 1px solid #444; border-radius: 12px; cursor: pointer; width: 55px; height: 55px; padding: 5px; transition: 0.3s; }
        .btn-filter-logo.active { border-color: var(--claro-red); box-shadow: 0 0 10px var(--claro-red); }
        .btn-filter-logo img { width: 100%; height: 100%; object-fit: contain; }

        .grid-layout { display: grid; grid-template-columns: repeat(5, 1fr); gap: 15px; margin-bottom: 50px; }
        .card { background: var(--surface); border-radius: 15px; overflow: hidden; display: flex; flex-direction: column; border: 1px solid #333; position: relative; }
        
        .streaming-frame { background: #000; padding: 8px; display: flex; justify-content: center; gap: 8px; border-bottom: 2px solid var(--claro-red); min-height: 35px; }
        .mini-logo { width: 25px; height: 25px; border-radius: 4px; }
        
        .release-date { position: absolute; top: 50px; right: 10px; background: var(--claro-red); padding: 5px 10px; border-radius: 5px; font-size: 0.7rem; font-weight: bold; }

        .card-poster { width: 100%; aspect-ratio: 2/3; object-fit: cover; }
        .card-content { padding: 15px; flex-grow: 1; }
        .card-title { font-size: 0.95rem; margin: 0 0 10px 0; height: 40px; overflow: hidden; font-weight: bold; }
        
        .btn-yt { background: var(--claro-red); color: white; border: none; padding: 10px; border-radius: 8px; cursor: pointer; width: 100%; font-weight: bold; }
        
        @media (max-width: 1024px) { .grid-layout { grid-template-columns: repeat(2, 1fr); } }
    </style>
</head>
<body>

    <nav class="header-nav">
        <button class="btn-coming-soon" onclick="buscarVemAi()">üìÖ VEM A√ç...</button>

        <div class="dropdown">
            <button class="dropbtn">EXPLORAR TEMPO</button>
            <div class="dropdown-content">
                <a onclick="setPeriodo('2026-01-01')">‚úì 2026 (Atual)</a>
                <a onclick="setPeriodo('2025-01-01')">De 2025 at√© hoje</a>
                <a onclick="setPeriodo('2024-01-01')">De 2024 at√© hoje</a>
                <a onclick="setPeriodo('')">Todo o hist√≥rico</a>
            </div>
        </div>

        <div class="streaming-filters" id="filter-container">
            <button class="btn-filter-logo" onclick="setStreaming(8, this)" title="Netflix"><img src="https://www.themoviedb.org/t/p/original/wwemzKWzjKYJFfCeiB57q3r4Bcm.png"></button>
            <button class="btn-filter-logo" onclick="setStreaming(337, this)" title="Disney+"><img src="https://www.themoviedb.org/t/p/original/78S08rmPB9Pb9STpS5fRA9L6tbr.png"></button>
            <button class="btn-filter-logo" onclick="setStreaming(384, this)" title="HBO Max"><img src="https://www.themoviedb.org/t/p/original/aSj9vP8AnY9Y7V070p880p9v99R.png"></button>
            <button class="btn-filter-logo" onclick="setStreaming(119, this)" title="Prime Video"><img src="https://www.themoviedb.org/t/p/original/dQeYvS7y7Xv9vxV9G67pk69t9cn.png"></button>
            <button class="btn-filter-logo" onclick="setStreaming(350, this)" title="Apple TV"><img src="https://www.themoviedb.org/t/p/original/68vAnU6AIpX99BsV9whuR9exbiW.png"></button>
            <button class="btn-filter-logo" onclick="setStreaming(307, this)" title="Globoplay"><img src="https://www.themoviedb.org/t/p/original/8vS3X67pX90Y1XjXv9whuR9exbiW.png"></button>
        </div>
    </nav>

    <main>
        <h2 id="t1">üé¨ Filmes</h2>
        <div id="grid-filmes" class="grid-layout"></div>
        <h2 id="t2">üçø S√©ries</h2>
        <div id="grid-series" class="grid-layout"></div>
    </main>

    <script>
        const API_KEY = "a3e15f985435c14269f8f3e9bfacb207";
        const BASE_URL = "https://api.themoviedb.org/3";
        
        // VARI√ÅVEIS DE ESTADO (Para combinar os filtros)
        let streamingAtual = "";
        let periodoAtual = "";

        async function init() {
            aplicarFiltros();
        }

        // Seleciona o Per√≠odo e mant√©m o streaming
        function setPeriodo(data) {
            periodoAtual = data ? `&primary_release_date.gte=${data}&first_air_date.gte=${data}` : '';
            aplicarFiltros();
        }

        // Seleciona o Streaming e mant√©m o per√≠odo
        function setStreaming(id, btn) {
            // Toggle de sele√ß√£o visual
            document.querySelectorAll('.btn-filter-logo').forEach(b => b.classList.remove('active'));
            if (streamingAtual.includes(id)) {
                streamingAtual = ""; // Deselecionar se clicar de novo
            } else {
                streamingAtual = `&with_watch_providers=${id}&watch_region=BR`;
                btn.classList.add('active');
            }
            aplicarFiltros();
        }

        async function aplicarFiltros() {
            const configBase = "&with_watch_monetization_types=flatrate&watch_region=BR";
            const filtroFinal = configBase + periodoAtual + streamingAtual;
            
            document.getElementById('t1').innerText = "üé¨ Filmes Selecionados";
            document.getElementById('t2').innerText = "üçø S√©ries Selecionadas";
            
            await carregarDados('movie', 'grid-filmes', filtroFinal);
            await carregarDados('tv', 'grid-series', filtroFinal);
        }

        async function buscarVemAi() {
            const hoje = new Date().toISOString().split('T')[0];
            const filtroVemAi = `&primary_release_date.gte=${hoje}&first_air_date.gte=${hoje}&sort_by=primary_release_date.asc`;
            
            document.getElementById('t1').innerText = "üìÖ Filmes: Vem A√≠...";
            document.getElementById('t2').innerText = "üìÖ S√©ries: Vem A√≠...";
            
            await carregarDados('movie', 'grid-filmes', filtroVemAi, true);
            await carregarDados('tv', 'grid-series', filtroVemAi, true);
        }

        async function carregarDados(tipo, containerId, extra, isVemAi = false) {
            const url = `${BASE_URL}/discover/${tipo}?api_key=${API_KEY}&language=pt-BR&page=1${extra}`;
            const res = await fetch(url);
            const data = await res.json();
            renderCards(data.results.slice(0, 5), containerId, tipo, isVemAi);
        }

        async function renderCards(lista, containerId, tipo, isVemAi) {
            const container = document.getElementById(containerId);
            container.innerHTML = lista.length ? "" : "<p style='padding:20px'>Nenhum conte√∫do encontrado para esta combina√ß√£o.</p>";
            
            for (const item of lista) {
                const providers = await getProviders(tipo, item.id);
                const dataRaw = item.release_date || item.first_air_date || "Em breve";
                const dataFormatada = dataRaw !== "Em breve" ? dataRaw.split('-').reverse().join('/') : "Em breve";
                
                container.innerHTML += `
                    <div class="card">
                        <div class="streaming-frame">${providers}</div>
                        ${isVemAi ? `<div class="release-date">ESTREIA: ${dataFormatada}</div>` : ''}
                        <img src="https://image.tmdb.org/t/p/w500${item.poster_path}" class="card-poster" onerror="this.src='https://via.placeholder.com/500x750?text=Em+Breve'">
                        <div class="card-content">
                            <h3 class="card-title">${item.title || item.name}</h3>
                            <button class="btn-yt" onclick="window.open('https://www.youtube.com/results?search_query=${item.title || item.name}+trailer+dublado')">Ver Trailer</button>
                        </div>
                    </div>`;
            }
        }

        async function getProviders(tipo, id) {
            const res = await fetch(`${BASE_URL}/${tipo}/${id}/watch/providers?api_key=${API_KEY}`);
            const data = await res.json();
            const br = data.results?.BR?.flatrate || [];
            return br.slice(0, 3).map(p => `<img src="https://image.tmdb.org/t/p/w500${p.logo_path}" class="mini-logo">`).join('');
        }

        init();
    </script>
</body>
</html>
